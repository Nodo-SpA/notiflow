(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[38],{2:function(e,t,a){Promise.resolve().then(a.bind(a,2998))},2998:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var s=a(7437),l=a(2265),r=a(2840),i=a(3260),n=a(7855),d=a(2449),o=a(1469),c=a(1994);let u=e=>{if(!e)return"";let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString()};function m(){let e=(0,d.tN)(e=>e.user),t=(0,d.tN)(e=>e.hasPermission),a=((null==e?void 0:e.role)||"").toUpperCase(),m="TEACHER"===a,x="SUPERADMIN"===a||"ADMIN"===a||"TEACHER"===a||t("events.create"),p=(0,l.useMemo)(()=>new Date,[]),g=p.getFullYear(),{year:h}=(0,d.GL)(),v=h||String(g),[f,y]=(0,l.useState)(()=>{let e=new Date;return new Date(e.getFullYear(),e.getMonth(),1)}),[j,b]=(0,l.useState)(()=>{let e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate())}),[N,w]=(0,l.useState)([]),[D,S]=(0,l.useState)(!1),[C,I]=(0,l.useState)(""),[T,E]=(0,l.useState)(!1),[M,k]=(0,l.useState)(!1),[A,L]=(0,l.useState)(null),[z,F]=(0,l.useState)(null),[Y,G]=(0,l.useState)(null),[O,R]=(0,l.useState)(""),[B,P]=(0,l.useState)(""),[U,Z]=(0,l.useState)(""),[_,H]=(0,l.useState)(""),[q,J]=(0,l.useState)("colegio"),[V,W]=(0,l.useState)([]),[K,X]=(0,l.useState)([]),[Q,$]=(0,l.useState)([]),[ee,et]=(0,l.useState)([]),[ea,es]=(0,l.useState)([]),[el,er]=(0,l.useState)(null),[ei,en]=(0,l.useState)(!1),[ed,eo]=(0,l.useState)(!1),[ec,eu]=(0,l.useState)(""),[em,ex]=(0,l.useState)(""),[ep,eg]=(0,l.useState)(""),[eh,ev]=(0,l.useState)("all"),[ef,ey]=(0,l.useState)(!0),ej=e=>"general"===e?"colegio":"schedule"===e?"evaluacion":e||"colegio",eb=e=>{var t,a;let s=e.audienceUserIds||(null===(t=e.audience)||void 0===t?void 0:t.userIds)||[],l=e.audienceGroupIds||(null===(a=e.audience)||void 0===a?void 0:a.groupIds)||[];return{...e,audience:{userIds:s,groupIds:l},audienceUserIds:s,audienceGroupIds:l}},eN=async()=>{S(!0),I("");try{let e=((await n.x.getEvents()).data||[]).map(eb);w(e)}catch(l){var e,t,a,s;w([{id:"sample-1",title:"Reuni\xf3n de apoderados",description:"Revisi\xf3n de avances y notas del trimestre.",startDateTime:new Date().toISOString(),endDateTime:new Date(Date.now()+36e5).toISOString(),type:"reunion",createdByName:"Coordinaci\xf3n"},{id:"sample-2",title:"Horario de Matem\xe1ticas 4\xb0B",description:"Clases semanales de matem\xe1ticas (horario escolar).",startDateTime:new Date().toISOString(),type:"evaluacion",createdByName:"Prof. G\xf3mez"}].map(eb)),I((null==l?void 0:null===(t=l.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||(null==l?void 0:null===(s=l.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.error)||(null==l?void 0:l.message)||"No pudimos cargar los eventos")}finally{S(!1)}},ew=async()=>{eo(!0);try{var t,a,s;let[l,r,i]=await Promise.allSettled([n.x.getUsers(),n.x.getGroups(void 0,v),n.x.getStudents({page:1,pageSize:500,schoolId:(null==e?void 0:e.schoolId)||void 0,year:v})]);if("fulfilled"===l.status){let e=l.value.data||[];$(e.map(e=>({...e,badge:"Usuario"})))}if("fulfilled"===r.status){let e=r.value.data||[];et(null!==(a=null!==(t=e.items)&&void 0!==t?t:e)&&void 0!==a?a:[])}if(i&&"fulfilled"===i.status){let e=((null===(s=i.value)||void 0===s?void 0:s.data)||{}).items||[];es(e.map(e=>({id:e.id,name:"".concat(e.firstName||""," ").concat(e.lastNameFather||""," ").concat(e.lastNameMother||"").trim(),email:e.email})))}}finally{eo(!1)}};(0,l.useEffect)(()=>{if(!m||!(null==e?void 0:e.email)){er(null);return}let t=!0;return en(!0),n.x.getTeacherPermissions().then(a=>{var s;if(!t)return;let l=Array.isArray(a.data)?a.data:[],r=l.find(t=>{var a;return((null==t?void 0:t.email)||"").toLowerCase()===(null===(a=e.email)||void 0===a?void 0:a.toLowerCase())}),i=(null==r?void 0:r.allowedGroupIds)||(null===(s=l[0])||void 0===s?void 0:s.allowedGroupIds)||[];er(Array.isArray(i)?i:[])}).catch(()=>{t&&er([])}).finally(()=>{t&&en(!1)}),()=>{t=!1}},[m,null==e?void 0:e.email]),(0,l.useEffect)(()=>{eN(),ew()},[v]),(0,l.useEffect)(()=>{m&&el&&X(e=>e.filter(e=>el.includes(e)))},[m,el]);let eD=(0,l.useMemo)(()=>{let e=ep.toLowerCase(),t=parseInt(v||"".concat(g),10);return N.filter(e=>{let a=new Date(e.startDateTime||e.createdAt||"");return!Number.isNaN(a.getTime())&&a.getFullYear()===t}).filter(t=>{var a,s;let l=!e||(null===(a=t.title)||void 0===a?void 0:a.toLowerCase().includes(e))||(null===(s=t.description)||void 0===s?void 0:s.toLowerCase().includes(e)),r=ej(t.type||""),i="all"===eh||r===eh;return l&&i}).sort((e,t)=>new Date(e.startDateTime||e.createdAt||"").getTime()-new Date(t.startDateTime||t.createdAt||"").getTime())},[N,ep,eh,g]),eS=(0,l.useMemo)(()=>{if(!ef)return eD;let e=new Date,t=new Date;return t.setDate(e.getDate()+14),eD.filter(a=>{let s=new Date(a.startDateTime||a.createdAt||"").getTime();return s>=e.getTime()-864e5&&s<=t.getTime()})},[eD,ef]),eC=(0,l.useMemo)(()=>({total:eD.length,upcoming:eD.filter(e=>new Date(e.startDateTime||e.createdAt||"").getTime()>=p.getTime()-864e5).length,today:eD.filter(e=>{let t=new Date(e.startDateTime||e.createdAt||"");return t.getFullYear()===p.getFullYear()&&t.getMonth()===p.getMonth()&&t.getDate()===p.getDate()}).length}),[eD,p]),eI=(e,t,a)=>{a(t.includes(e)?t.filter(t=>t!==e):[...t,e])},eT=(0,l.useMemo)(()=>{if(!m)return ee;if(!el)return[];let e=new Set(el);return ee.filter(t=>e.has(t.id))},[ee,m,el]),eE=(0,l.useMemo)(()=>{if(!m||!el)return{ids:new Set,emails:new Set};let e=new Set(el),t=new Set,a=new Set;return ee.forEach(s=>{e.has(s.id)&&(s.memberIds||[]).forEach(e=>{let s=(e||"").trim();s&&(s.includes("@")?a.add(s.toLowerCase()):t.add(s))})}),{ids:t,emails:a}},[ee,m,el]),eM=(0,l.useMemo)(()=>{if(!m)return ea;let e=eE.ids,t=eE.emails;return el&&0!==el.length?ea.filter(a=>{if(e.has(a.id))return!0;let s=(a.email||"").trim().toLowerCase();return s&&t.has(s)}):[]},[ea,m,eE,el]),ek=(0,l.useMemo)(()=>{let e=[...eM.map(e=>({id:e.email||e.id,name:e.name,email:e.email,badge:"Alumno"})),...Q.map(e=>({id:e.email||e.id,name:e.name||e.email,email:e.email,badge:e.badge||"Usuario"}))].filter(e=>e.id);if(!ec.trim())return e;let t=ec.toLowerCase();return e.filter(e=>(e.name||"").toLowerCase().includes(t)||(e.email||"").toLowerCase().includes(t)||(e.badge||"").toLowerCase().includes(t))},[Q,eM,ec]),eA=(0,l.useMemo)(()=>{if(!em.trim())return eT;let e=em.toLowerCase();return eT.filter(t=>t.name.toLowerCase().includes(e))},[eT,em]),eL=()=>{R(""),P(""),Z(""),H(""),J("colegio"),X([]),W([]),F(null)},ez=async e=>{if(e.preventDefault(),O.trim()&&U){k(!0);try{let e=e=>{if(!e)return"";let t=new Date(e);return isNaN(t.getTime())?e:t.toISOString()},t={title:O.trim(),description:B.trim(),startDateTime:e(U),endDateTime:_?e(_):void 0,type:q,audience:{userIds:V,groupIds:K}};z&&(t.id=z);let a=await n.x.createEvent(t),s=eb(a.data||t);w(e=>{let t=e.findIndex(e=>e.id===s.id);if(t>=0){let a=[...e];return a[t]=s,a}return[s,...e]}),E(!1),eL()}catch(e){var t,a,s,l;alert((null==e?void 0:null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(s=l.data)||void 0===s?void 0:s.error)||(null==e?void 0:e.message)||"No pudimos crear el evento. Intenta nuevamente.")}finally{k(!1)}}},eF=e=>{var t,a;R(e.title||""),P(e.description||"");let s=e.startDateTime?new Date(e.startDateTime):new Date;s.setDate(s.getDate()+7);let l=e.endDateTime?new Date(e.endDateTime):null;l&&l.setDate(l.getDate()+7),Z(s.toISOString().slice(0,16)),H(l?l.toISOString().slice(0,16):""),J(ej(e.type)),X(e.audienceGroupIds||(null===(t=e.audience)||void 0===t?void 0:t.groupIds)||[]),W(e.audienceUserIds||(null===(a=e.audience)||void 0===a?void 0:a.userIds)||[]),F(null),E(!0)},eY=e=>"evaluacion"===e||"schedule"===e?{label:"Evaluaci\xf3n",color:"bg-purple-100 text-purple-800"}:"reunion"===e?{label:"Reuni\xf3n apoderados",color:"bg-amber-100 text-amber-800"}:{label:"Evento colegio",color:"bg-blue-100 text-blue-800"},eG=new Intl.DateTimeFormat("es",{month:"long",year:"numeric"}).format(f),eO=(0,l.useMemo)(()=>{let e=new Date(f.getFullYear(),f.getMonth(),1),t=0===e.getDay()?7:e.getDay(),a=new Date(f.getFullYear(),f.getMonth()+1,0).getDate(),s=[];for(let e=1;e<t;e++)s.push(null);for(let e=1;e<=a;e++)s.push(new Date(f.getFullYear(),f.getMonth(),e));for(;s.length%7!=0;)s.push(null);return s},[f]),eR=(0,l.useMemo)(()=>{let e={};return eD.forEach(t=>{let a=(t.startDateTime||t.createdAt||"").slice(0,10);e[a]||(e[a]=[]),e[a].push(t)}),e},[eD]),eB=j?j.toISOString().slice(0,10):null,eP=eB&&eR[eB]||[],eU=(0,l.useMemo)(()=>{let e=new Date,t=new Date;return t.setDate(e.getDate()+7),eD.filter(a=>{let s=new Date(a.startDateTime||a.createdAt||"").getTime();return s>=e.getTime()-864e5&&s<=t.getTime()}).sort((e,t)=>new Date(e.startDateTime||e.createdAt||"").getTime()-new Date(t.startDateTime||t.createdAt||"").getTime())},[eD]),eZ=t=>{let s=((null==e?void 0:e.email)||"").toLowerCase(),l=((null==e?void 0:e.schoolId)||"").toLowerCase(),r=(t.schoolId||"").toLowerCase(),i=(t.createdBy||t.createdByEmail||"").toLowerCase();return"SUPERADMIN"===a?i&&i===s:"ADMIN"===a?r&&l&&r===l:"TEACHER"===a&&i===s&&r===l},e_=async e=>{if(!A){L(e),I("");try{await n.x.deleteEvent(e),w(t=>t.filter(t=>t.id!==e)),G(null)}catch(e){var t,a,s,l;I((null==e?void 0:null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(s=l.data)||void 0===s?void 0:s.error)||(null==e?void 0:e.message)||"No se pudo eliminar el evento")}finally{L(null)}}};return(0,s.jsx)(r.I,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,s.jsxs)("header",{className:"glass-panel rounded-2xl p-4 sm:p-5 soft-shadow flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Agenda escolar"}),(0,s.jsxs)("h1",{className:"text-3xl font-bold text-secondary flex items-center gap-2",children:[(0,s.jsx)(o.vlc,{}),"Eventos y horarios"]}),(0,s.jsx)("p",{className:"text-gray-600",children:"Planifica reuniones, clases especiales y actividades del colegio."})]}),x&&(0,s.jsxs)(i.zx,{onClick:()=>E(!0),size:"md",children:[(0,s.jsx)(o.OvN,{}),"Nuevo evento"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[(0,s.jsxs)(i.Zb,{className:"p-4",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Eventos del a\xf1o"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-secondary",children:eC.total})]}),(0,s.jsxs)(i.Zb,{className:"p-4",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Pr\xf3ximos 14 d\xedas"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-secondary",children:eC.upcoming})]}),(0,s.jsxs)(i.Zb,{className:"p-4",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Hoy"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-secondary",children:eC.today})]})]}),(0,s.jsxs)(i.Zb,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-3",children:[(0,s.jsx)("button",{type:"button",className:"p-2 rounded-lg hover:bg-gray-100",onClick:()=>y(new Date(f.getFullYear(),f.getMonth()-1,1)),children:(0,s.jsx)(o.YFh,{})}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 capitalize",children:eG}),(0,s.jsx)("button",{type:"button",className:"p-2 rounded-lg hover:bg-gray-100",onClick:()=>y(new Date(f.getFullYear(),f.getMonth()+1,1)),children:(0,s.jsx)(o.Tfp,{})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{type:"button",className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm hover:border-primary",onClick:()=>{let e=new Date;y(new Date(e.getFullYear(),e.getMonth(),1)),b(e)},children:"Ir a hoy"}),(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,s.jsx)("input",{type:"checkbox",checked:ef,onChange:()=>ey(e=>!e)}),"Solo pr\xf3ximos 14 d\xedas"]})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-7 text-center text-xs font-semibold text-gray-500 mb-2",children:["L","M","X","J","V","S","D"].map(e=>(0,s.jsx)("span",{children:e},e))}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-2",children:eO.map((e,t)=>{if(!e)return(0,s.jsx)("div",{},"empty-".concat(t));let a=e.toISOString().slice(0,10),l=eR[a]||[],r=eB===a;return(0,s.jsxs)("button",{onClick:()=>b(e),onDoubleClick:()=>{b(e),Z(new Date(e.getFullYear(),e.getMonth(),e.getDate(),8,0).toISOString().slice(0,16)),E(!0)},className:(0,c.Z)("h-16 rounded-xl border text-sm flex flex-col items-center justify-center gap-1 transition-all",r?"border-primary bg-primary/10 shadow-sm":"border-gray-200 hover:bg-gray-50"),children:[(0,s.jsx)("span",{className:"font-semibold text-gray-800",children:e.getDate()}),l.length>0&&(0,s.jsxs)("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-blue-100 text-blue-700",children:[l.length," evento(s)"]})]},a)})}),j&&(0,s.jsx)("div",{className:"mt-4 flex items-center justify-between",children:(0,s.jsxs)("div",{className:"text-sm text-gray-700",children:["Eventos del ",j.toLocaleDateString(),eP.length?" (".concat(eP.length,")"):""]})})]}),(0,s.jsxs)(i.Zb,{className:"p-5 flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Agenda r\xe1pida"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Pr\xf3ximos eventos (7 d\xedas)"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Vista resumida de lo que viene esta semana."})]}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:D?"Cargando...":"".concat(eU.length," evento(s) pr\xf3ximos")})]}),C&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:C}),(0,s.jsxs)("div",{className:"space-y-3",children:[0===eU.length&&(0,s.jsx)("div",{className:"p-3 rounded-lg bg-gray-50 text-sm text-gray-600",children:"No hay eventos programados para los pr\xf3ximos 7 d\xedas."}),eU.map(e=>{let t=eY(e.type);return(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 border border-transparent glass-panel rounded-xl p-3 hover:translate-y-[-2px] transition-all",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,s.jsx)("span",{className:"text-sm text-gray-500",children:u(e.startDateTime)}),(0,s.jsx)("span",{className:(0,c.Z)("px-2 py-0.5 rounded-full text-xs font-semibold",t.color),children:t.label})]}),(0,s.jsx)("p",{className:"text-base font-semibold text-gray-900",children:e.title||"Sin t\xedtulo"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.description||"Sin descripci\xf3n"})]}),eZ(e)&&(0,s.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>{confirm("\xbfEliminar este evento?")&&e_(e.id)},disabled:A===e.id,children:A===e.id?"Eliminando...":"Eliminar"})]},e.id)})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[(eB?eP:eS).map(e=>{var t,a,l,r,n;let d=eY(e.type);return(0,s.jsxs)(i.Zb,{className:"p-4 flex flex-col gap-3",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.title}),e.createdByName&&(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Creado por ",e.createdByName]})]}),(0,s.jsx)("span",{className:(0,c.Z)("px-3 py-1 rounded-full text-xs font-semibold",d.color),children:d.label})]}),(0,s.jsx)("p",{className:"text-gray-700",children:e.description||"Sin descripci\xf3n"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm text-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.TCC,{className:"text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold",children:u(e.startDateTime)}),e.endDateTime&&(0,s.jsxs)("div",{className:"text-gray-500",children:["Hasta ",u(e.endDateTime)]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.WY8,{className:"text-primary"}),(0,s.jsxs)("span",{children:[(e.audienceUserIds||(null===(t=e.audience)||void 0===t?void 0:t.userIds)||[]).length," personas â€¢ ",(e.audienceGroupIds||(null===(a=e.audience)||void 0===a?void 0:a.groupIds)||[]).length," grupos"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs text-gray-600",children:[(e.audienceGroupIds||(null===(l=e.audience)||void 0===l?void 0:l.groupIds)||[]).slice(0,3).map(e=>(0,s.jsx)("span",{className:"px-2 py-1 bg-gray-100 rounded-full",children:e},e)),(e.audienceGroupIds||(null===(r=e.audience)||void 0===r?void 0:r.groupIds)||[]).length>3&&(0,s.jsxs)("span",{className:"px-2 py-1 bg-gray-50 rounded-full",children:["+",(e.audienceGroupIds||(null===(n=e.audience)||void 0===n?void 0:n.groupIds)||[]).length-3," grupos"]})]}),x&&(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>eF(e),children:"Duplicar"}),(0,s.jsx)(i.zx,{size:"sm",variant:"secondary",onClick:()=>{var t,a,s,l;R(e.title||""),P(e.description||""),Z((null===(t=e.startDateTime)||void 0===t?void 0:t.slice(0,16))||""),H((null===(a=e.endDateTime)||void 0===a?void 0:a.slice(0,16))||""),J(ej(e.type)),X(e.audienceGroupIds||(null===(s=e.audience)||void 0===s?void 0:s.groupIds)||[]),W(e.audienceUserIds||(null===(l=e.audience)||void 0===l?void 0:l.userIds)||[]),F(e.id||null),E(!0)},children:"Editar borrador"}),eZ(e)&&(0,s.jsx)(i.zx,{size:"sm",variant:"danger",onClick:()=>G(e),disabled:A===e.id,children:A===e.id?"Eliminando...":"Eliminar"})]})]})]},e.id)}),!D&&!eD.length&&(0,s.jsx)(i.Zb,{className:"p-6 text-center text-gray-600",children:"No hay eventos en la agenda todav\xeda."})]}),(0,s.jsx)(i.u_,{isOpen:!!Y,onClose:()=>{A||G(null)},title:"Eliminar evento",size:"sm",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-red-100 text-red-600",children:(0,s.jsx)(o.BJv,{})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-900 font-semibold",children:"\xbfEliminar evento?"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Esta acci\xf3n no se puede deshacer."})]})]}),(0,s.jsx)("div",{className:"rounded-lg border border-red-100 bg-red-50 px-3 py-2 text-sm text-red-700",children:(0,s.jsx)("span",{className:"font-semibold",children:(null==Y?void 0:Y.title)||"Evento sin t\xedtulo"})}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-1",children:[(0,s.jsx)(i.zx,{variant:"outline",onClick:()=>G(null),disabled:!!A,children:"Cancelar"}),(0,s.jsx)(i.zx,{variant:"danger",onClick:()=>Y&&e_(Y.id),disabled:!!A,children:A?"Eliminando...":"Eliminar"})]})]})}),(0,s.jsx)(i.u_,{isOpen:T,onClose:()=>E(!1),title:"Crear evento",size:"xl",children:(0,s.jsxs)("form",{className:"space-y-6",onSubmit:ez,children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[(0,s.jsxs)("div",{className:"lg:col-span-7 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Nuevo evento"}),(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Detalles"})]}),(0,s.jsx)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:(0,s.jsx)("span",{className:"px-2 py-1 rounded-full bg-primary/10 text-primary border border-primary/20",children:"colegio"===q?"Evento del colegio":"evaluacion"===q?"Evaluaci\xf3n":"Reuni\xf3n de apoderados"})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.II,{label:"T\xedtulo del evento",value:O,onChange:e=>R(e.target.value),required:!0,placeholder:"Ej: Reuni\xf3n de apoderados"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:[{value:"colegio",label:"Evento del colegio"},{value:"evaluacion",label:"Evaluaci\xf3n"},{value:"reunion",label:"Reuni\xf3n de apoderados"}].map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>J(e.value),className:"px-3 py-1.5 rounded-full border text-sm ".concat(q===e.value?"bg-primary text-white border-primary":"border-gray-200 text-gray-700 hover:border-primary"),children:e.label},e.value))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Inicio"}),(0,s.jsx)("input",{type:"datetime-local",value:U,onChange:e=>Z(e.target.value),required:!0,className:"w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent border-gray-200"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Fin (opcional)"}),(0,s.jsx)("input",{type:"datetime-local",value:_,onChange:e=>H(e.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent border-gray-200"})]})]}),(0,s.jsx)(i.Kx,{label:"Descripci\xf3n",value:B,onChange:e=>P(e.target.value),placeholder:"Agrega detalles \xfatiles (sala, material, recordatorios...)",rows:3})]}),(0,s.jsxs)("div",{className:"lg:col-span-5 space-y-4",children:[(0,s.jsxs)("div",{className:"bg-gray-50 border border-gray-100 rounded-xl p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-900 font-semibold",children:[(0,s.jsx)(o.WY8,{}),"Destinatarios (opcional)"]}),(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:[V.length+K.length," seleccionados"]})]}),(0,s.jsx)("input",{type:"search",value:ec,onChange:e=>eu(e.target.value),placeholder:"Buscar por nombre o correo",className:"w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent border-gray-200"}),(0,s.jsxs)("div",{className:"max-h-72 overflow-y-auto space-y-2 pr-1",children:[(ed||ei)&&(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Cargando..."}),!(ed||ei)&&ek.map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-3 text-sm cursor-pointer bg-white border border-gray-200 rounded-lg px-3 py-2 hover:border-primary transition",children:[(0,s.jsx)("input",{type:"checkbox",checked:V.includes(e.id),onChange:()=>eI(e.id,V,W)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"font-semibold text-gray-800 truncate",children:e.name||e.email}),(0,s.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.email})]}),(0,s.jsx)("span",{className:"text-[11px] px-2 py-1 rounded-full border border-gray-200 bg-gray-50 text-gray-600",children:e.badge})]},e.id))]}),V.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:V.map(e=>{let t=ek.find(t=>t.id===e);return(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-xs",children:[(null==t?void 0:t.name)||(null==t?void 0:t.email)||e,(0,s.jsx)("button",{type:"button",onClick:()=>eI(e,V,W),children:(0,s.jsx)(o.q5L,{size:12})})]},e)})})]}),(0,s.jsxs)("div",{className:"bg-gray-50 border border-gray-100 rounded-xl p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm font-semibold text-gray-900",children:[(0,s.jsx)("span",{children:"Grupos"}),(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:[eA.length," disponibles"]})]}),(0,s.jsx)("input",{type:"search",value:em,onChange:e=>ex(e.target.value),placeholder:"Buscar grupo",className:"w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent border-gray-200"}),(0,s.jsxs)("div",{className:"max-h-60 overflow-y-auto space-y-2 pr-1",children:[(ed||ei)&&(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Cargando..."}),!(ed||ei)&&eA.map(e=>{var t;return(0,s.jsxs)("label",{className:"flex items-center gap-3 text-sm cursor-pointer bg-white border border-gray-200 rounded-lg px-3 py-2 hover:border-primary transition",children:[(0,s.jsx)("input",{type:"checkbox",checked:K.includes(e.id),onChange:()=>eI(e.id,K,X)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"font-semibold text-gray-800 truncate",children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:[(null===(t=e.memberIds)||void 0===t?void 0:t.length)||0," miembros"]})]})]},e.id)})]}),K.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:K.map(e=>{let t=ee.find(t=>t.id===e);return(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 bg-primary/15 text-primary px-3 py-1 rounded-full text-xs",children:[(null==t?void 0:t.name)||e,(0,s.jsx)("button",{type:"button",onClick:()=>eI(e,K,X),children:(0,s.jsx)(o.q5L,{size:12})})]},e)})})]})]})]}),(0,s.jsx)("div",{className:"flex justify-end gap-3 pt-2",children:(0,s.jsx)(i.zx,{variant:"primary",type:"submit",disabled:M||!O.trim()||!U,className:"min-w-[160px]",children:M?"Guardando...":"Guardar evento"})})]})})]})})}}},function(e){e.O(0,[502,619,648,785,255,462,971,117,744],function(){return e(e.s=2)}),_N_E=e.O()}]);